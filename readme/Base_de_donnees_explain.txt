# Documentation du Script d'Importation de Livres

## Structure de la Table "books"

La table **books** contient les informations suivantes :

- **id** (INT, clé primaire, auto-incrémentée)
- **titre** (VARCHAR 255, non nul)
- **prix** (DECIMAL 10,2, non nul)
- **categorie** (VARCHAR 100, non nul)
- **disponibilite** (VARCHAR 50, non nul, valeurs possibles : "En stock", "Rupture de stock")
- **note** (INT, non nul, valeur comprise entre 1 et 5)
- **lien** (TEXT, non nul)
- **description** (TEXT, optionnel)
- **moyenne_avis** (DECIMAL 10,2, optionnel, représente la moyenne des notes des livres importés)

---

## Format Attendu du Fichier CSV

Le fichier CSV doit contenir les colonnes suivantes :

- **titre** : Titre du livre (obligatoire)
- **prix** : Prix du livre au format décimal (ex. "9.99") (obligatoire)
- **categorie** : Catégorie du livre, normalisée avec une majuscule au début (obligatoire)
- **disponibilite** : Doit être "En stock" ou "Rupture de stock" (obligatoire)
- **note** : Note du livre, exprimée en entier (1 à 5) ou en texte ("un", "deux", etc.) qui sera converti (obligatoire)
- **lien** : Lien vers le livre (obligatoire)
- **description** : Description du livre (optionnel)

---

## Étapes du Script

1. **Connexion à la base MySQL**
   - Connexion avec les identifiants fournis (hôte, utilisateur, mot de passe, base de données)

2. **Vérification et création de la table**
   - Création de la table **books** si elle n'existe pas, avec les champs définis ci-dessus

3. **Chargement et nettoyage des données CSV**
   - Vérification des colonnes obligatoires
   - Nettoyage des prix (suppression du symbole £, conversion en décimal)
   - Remplacement des valeurs nulles dans la colonne **description** par une chaîne vide
   - Conversion des notes textuelles en valeurs numériques ("un" → 1, "deux" → 2, etc.)
   - Normalisation des catégories (première lettre en majuscule)

4. **Vérification des contraintes**
   - Vérification que toutes les valeurs obligatoires sont présentes
   - Vérification que le prix est strictement positif
   - Affichage des erreurs en cas de données invalides

5. **Insertion des données dans la base**
   - Calcul de la **moyenne des avis** des livres importés et ajout à la table
   - Insertion des données nettoyées et validées dans la base MySQL

6. **Gestion des erreurs et fermeture de la connexion**
   - Gestion des exceptions en cas d'erreur et rollback si nécessaire
   - Fermeture propre de la connexion MySQL

---

## Remarque

- Toute anomalie détectée dans les données (prix invalide, note inconnue, valeurs manquantes) entraîne l'affichage d'un message d'erreur et l'arrêt du script.
- Assurez-vous que le fichier CSV respecte bien le format attendu pour éviter des erreurs lors de l'importation.

---

## Exemple de Données CSV Valides

```csv
titre,prix,categorie,disponibilite,note,lien,description
"Le Petit Prince",9.99,"Littérature","En stock",5,"http://exemple.com","Un classique incontournable."
"Python pour les Nuls",19.95,"Informatique","En stock",4,"http://exemple.com/python","Apprenez Python facilement."
```

